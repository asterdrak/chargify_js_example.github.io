<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Chargify Example</title>
<!--    <link rel="stylesheet" type="text/css" href="./example/host.css" />-->
  </head>

  <body>
    <form id="payment-types" style="display: none; margin-bottom: 20px;">
      <input type="radio" id="payment-type-card" name="type" value="card" checked>Credit Card<br>
      <input type="radio" id="payment-type-bank" name="type" value="bank">Bank Account<br>
    </form>

    <div id="apple-pay-validation-errors"></div>
    <div id="pay-pal-validation-errors"></div>

    <form class="host-form">
      <h2 id="credit-card-info">Credit Card Info</h2>

      <div id="gocardless-header"></div>

      <div id='gocardless-toggle-iban-or-local-details'></div>
      <div id="chargify-form"></div>

      <h2 id="billing-info">Billing Info</h2>
      <div id="gocardless-footer"></div>

      <div id="chargify-billing"></div>

      <h2 id="bank-info">Bank Info</h2>

      <div id="chargify-bank"></div>

      <div id="apple-pay"></div>

      <div id="pay-pal" style="width: 300px"></div>

      <label>
        Hidden Token: <input id="host-token" disabled />
      </label>

      <button type="submit" class="host-button">Submit Host Form</button>
    </form>

    <div id="example-card-numbers">
      <p>Handy credit card number examples:</p>
      visa: 4111111111111111 <br />
      amex: 371449635398431 <br />
      master: 5555555555554444 <br />
      3ds: 4000000000001091 <br />
      3ds (Wincave): 5453010000095323, password: secone1
    </div>

    <script src="https://js.staging-chargify.com/latest/chargify.js"></script>

    <script>
      const chargify = new Chargify();
      chargify.load({
        // selector where the iframe will be included in the host's HTML (i.e. '#chargify-form')
        // optional if you have a `selector` on each and every field
        selector: '#chargify-form',

        // (i.e. '1a2cdsdn3lkn54lnlkn')
        publicKey: 'chjs_7vcpfmc9qm8md66hyrznhqn6',

        // form type (possible values: 'card' or 'bank')
        type: 'card',

        // points to your Chargify site
        serverHost: 'newstripejakubmikrut.staging-chargify.com',

      });
    </script>

    <script>
      document.querySelector('.host-form').addEventListener('submit', function (event) {
        const form = this;

        event.preventDefault();

        if (typeof onSubmitForm === 'function') {
          onSubmitForm(); // eslint-disable-line no-undef
        } else {
          chargify.token(
            form,

            (token, message) => {
              console.log('{host} token SUCCESS - token: ', token); // eslint-disable-line no-console

              // host will write token in hidden input
              document.querySelector('#host-token').value = token;

              // and then submit form
              // form.submit();
              console.log('{host} form submitted'); // eslint-disable-line no-console

              // if there is message show it via alert
              if (message) {
                alert(message);
              }
            },

            (err) => {
              console.log('{host} token ERROR - err: ', err); // eslint-disable-line no-console
            },
          );
        }
      });
    </script>
  </body>
</html>
